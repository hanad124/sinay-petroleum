{"version":3,"file":"index.esm.js","sources":["../src/useBeforeunload.js","../src/Beforeunload.js"],"sourcesContent":["import { useEffect, useRef } from 'react';\nimport invariant from 'tiny-invariant';\n\nconst useBeforeunload = (handler) => {\n  invariant(\n    handler == null || typeof handler === 'function',\n    'Expected `handler` to be a function'\n  );\n\n  const eventListenerRef = useRef();\n\n  useEffect(() => {\n    eventListenerRef.current = (event) => {\n      const returnValue = handler?.(event);\n      // Handle legacy `event.returnValue` property\n      // https://developer.mozilla.org/en-US/docs/Web/API/Window/beforeunload_event\n      if (typeof returnValue === 'string') {\n        return (event.returnValue = returnValue);\n      }\n      // Chrome doesn't support `event.preventDefault()` on `BeforeUnloadEvent`,\n      // instead it requires `event.returnValue` to be set\n      // https://developer.mozilla.org/en-US/docs/Web/API/WindowEventHandlers/onbeforeunload#browser_compatibility\n      if (event.defaultPrevented) {\n        return (event.returnValue = '');\n      }\n    };\n  }, [handler]);\n\n  useEffect(() => {\n    const eventListener = (event) => eventListenerRef.current(event);\n    window.addEventListener('beforeunload', eventListener);\n    return () => {\n      window.removeEventListener('beforeunload', eventListener);\n    };\n  }, []);\n};\n\nexport default useBeforeunload;\n","import PropTypes from 'prop-types';\nimport useBeforeunload from './useBeforeunload';\n\nconst Beforeunload = ({ children = null, onBeforeunload }) => {\n  useBeforeunload(onBeforeunload);\n  return children;\n};\n\nBeforeunload.propTypes /* remove-proptypes */ = {\n  children: PropTypes.any,\n  onBeforeunload: PropTypes.func.isRequired,\n};\n\nexport default Beforeunload;\n"],"names":["useBeforeunload","handler","invariant","eventListenerRef","useRef","useEffect","current","event","returnValue","defaultPrevented","eventListener","window","addEventListener","removeEventListener","Beforeunload","children","onBeforeunload","propTypes","PropTypes","any","func","isRequired"],"mappings":";;;;AAGA,IAAMA,eAAe,GAAG,SAAlBA,eAAkB,CAACC,OAAD,EAAa;AACnC,EAAA,EACEA,OAAO,IAAI,IAAX,IAAmB,OAAOA,OAAP,KAAmB,UADxC,CAAA,GAAA,OAAA,CAAA,GAAA,CAAA,QAAA,KAAA,YAAA,GAAAC,SAAS,CAEP,KAAA,EAAA,qCAFO,CAAT,GAAAA,SAAS,CAAT,KAAA,CAAA,GAAA,KAAA,CAAA,CAAA;AAKA,EAAMC,IAAAA,gBAAgB,GAAGC,MAAM,EAA/B,CAAA;AAEAC,EAAAA,SAAS,CAAC,YAAM;AACdF,IAAAA,gBAAgB,CAACG,OAAjB,GAA2B,UAACC,KAAD,EAAW;AACpC,MAAMC,IAAAA,WAAW,GAAGP,OAAH,KAAGA,IAAAA,IAAAA,OAAH,KAAGA,KAAAA,CAAAA,GAAAA,KAAAA,CAAAA,GAAAA,OAAO,CAAGM,KAAH,CAA3B,CADoC;AAGpC;;AACA,MAAA,IAAI,OAAOC,WAAP,KAAuB,QAA3B,EAAqC;AACnC,QAAA,OAAQD,KAAK,CAACC,WAAN,GAAoBA,WAA5B,CAAA;AACD,OANmC;AAQpC;AACA;;;AACA,MAAID,IAAAA,KAAK,CAACE,gBAAV,EAA4B;AAC1B,QAAA,OAAQF,KAAK,CAACC,WAAN,GAAoB,EAA5B,CAAA;AACD,OAAA;AACF,KAbD,CAAA;AAcD,GAfQ,EAeN,CAACP,OAAD,CAfM,CAAT,CAAA;AAiBAI,EAAAA,SAAS,CAAC,YAAM;AACd,IAAA,IAAMK,aAAa,GAAG,SAAhBA,aAAgB,CAACH,KAAD,EAAA;AAAA,MAAA,OAAWJ,gBAAgB,CAACG,OAAjB,CAAyBC,KAAzB,CAAX,CAAA;AAAA,KAAtB,CAAA;;AACAI,IAAAA,MAAM,CAACC,gBAAP,CAAwB,cAAxB,EAAwCF,aAAxC,CAAA,CAAA;AACA,IAAA,OAAO,YAAM;AACXC,MAAAA,MAAM,CAACE,mBAAP,CAA2B,cAA3B,EAA2CH,aAA3C,CAAA,CAAA;AACD,KAFD,CAAA;AAGD,GANQ,EAMN,EANM,CAAT,CAAA;AAOD;;AChCD,IAAMI,YAAY,GAAG,SAAfA,YAAe,CAAyC,IAAA,EAAA;AAAA,EAAA,IAAA,aAAA,GAAA,IAAA,CAAtCC,QAAsC;AAAA,MAAtCA,QAAsC,8BAA3B,IAA2B,GAAA,aAAA;AAAA,MAArBC,cAAqB,QAArBA,cAAqB,CAAA;AAC5DhB,EAAAA,eAAe,CAACgB,cAAD,CAAf,CAAA;AACA,EAAA,OAAOD,QAAP,CAAA;AACD,EAHD;;AAKAD,YAAY,CAACG,SAAAA;AAAU;AAAvB,EAAgD,OAAA,CAAA,GAAA,CAAA,QAAA,KAAA,YAAA,GAAA;AAC9CF,EAAAA,QAAQ,EAAEG,SAAS,CAACC,GAD0B;AAE9CH,EAAAA,cAAc,EAAEE,SAAS,CAACE,IAAV,CAAeC,UAAAA;AAFe,CAAhD,GAAA,EAAA;;;;"}